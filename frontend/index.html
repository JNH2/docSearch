<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Word Document Filling MVP</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 700px;
            margin: 40px auto;
        }
        h1 {
            margin-bottom: 10px;
        }
        label {
            display: block;
            margin-top: 20px;
            font-weight: bold;
        }
        textarea {
            width: 100%;
            height: 120px;
        }
        button {
            margin-top: 20px;
            padding: 10px 16px;
            font-size: 16px;
        }
        #status {
            margin-top: 20px;
            color: green;
        }
    </style>
</head>
<body>

<h1>Word Document Filling Tool</h1>
<p>
    Upload a Word template, provide information via chat-style text,
    and download the filled document.
</p>

<label>1. Upload Word Template (.docx)</label>
<input type="file" id="fileInput" accept=".docx" />

<label>2. Chat Input</label>
<textarea id="messageInput" placeholder="Example:
First Name is John,
Last Name is Smith,
Company Name is Olymp,
Date is 2025-12-24"></textarea>

<button onclick="submitForm()">Fill Document</button>

<div id="status"></div>

<script>
async function submitForm() {
    const fileInput = document.getElementById("fileInput");
    const messageInput = document.getElementById("messageInput");
    const statusDiv = document.getElementById("status");

    if (!fileInput.files.length) {
        alert("Please select a Word document.");
        return;
    }

    const formData = new FormData();
    formData.append("file", fileInput.files[0]);
    formData.append("message", messageInput.value);

    statusDiv.innerText = "Processing...";

    try {
        const response = await fetch("/api/upload-and-fill", {
            method: "POST",
            body: formData
        });

        if (!response.ok) {
            throw new Error("Request failed");
        }

        const blob = await response.blob();
        const url = window.URL.createObjectURL(blob);

        const a = document.createElement("a");
        a.href = url;
        a.download = "filled_document.docx";
        document.body.appendChild(a);
        a.click();
        a.remove();

        statusDiv.innerText = "Document filled and downloaded successfully.";
    } catch (error) {
        statusDiv.innerText = "Error occurred. Check console.";
        console.error(error);
    }
}
</script>

</body>
</html>
